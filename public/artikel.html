<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>__OG_TITLE__ | OSIS</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/styles.css" />

    <!-- Open Graph / Facebook / WhatsApp -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="__OG_TITLE__">
    <meta property="og:description" content="__OG_DESCRIPTION__">
    <meta property="og:image" content="__OG_IMAGE__">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="__OG_TITLE__">
    <meta property="twitter:description" content="__OG_DESCRIPTION__">
    <meta property="twitter:image" content="__OG_IMAGE__">

    <meta name="theme-color" content="#111827" />
  </head>
  <body>
    <header class="site-header">
      <div class="container nav">
        <div class="brand">
          <div id="site-logo" class="logo"><img src="/uploads/logo.png" alt="Logo OSIS" style="height: 24px; width: auto; display: block;"></div>
          <span class="divider"></span>
          <span id="site-name" class="school">OSIS SMA NEGERI 1 BABAT</span>
        </div>
        <nav class="menu">
          <a href="/#beranda">Beranda</a>
          <a href="/#osis">Profil OSIS</a>
          <a href="/artikel-semua.html">Artikel</a>
          <a href="/#agenda">Agenda Kegiatan</a>
          <a href="/struktur.html">Struktur</a>
          <a href="/gallery.html">Galeri</a>
          <a href="/#saran">Saran/Laporan</a>
        </nav>
      </div>
    </header>

    <main class="section">
      <div class="container" style="max-width: 800px;">
        <div id="article-container">
          <!-- Konten artikel akan dimuat di sini oleh JavaScript -->
          <p class="hint">Memuat artikel...</p>
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p id="footer-text">Memuat footer...</p>
      </div>
    </footer>

    <script>
      // Fungsi renderSharedComponents dari shared.js akan menangani footer
      async function loadFullArticle() {
        const params = new URLSearchParams(window.location.search);
        const articleId = params.get('id');
        const container = document.getElementById('article-container');

        if (!articleId) {
          container.innerHTML = '<h2>Artikel tidak ditemukan.</h2><p>ID artikel tidak disertakan.</p>';
          return;
        }

        try {
          const res = await fetch(`/api/articles/${articleId}`);
          if (!res.ok) throw new Error('Artikel tidak ditemukan atau gagal dimuat.');
          const article = await res.json();

          document.title = `${article.title} | OSIS`; // Update judul halaman

          const currentUrl = window.location.href;
          const shareTitle = encodeURIComponent(article.title);
          const encodedUrl = encodeURIComponent(currentUrl);

          // Definisikan ikon SVG untuk setiap tombol
          const icons = {
            whatsapp: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.487 5.235 3.487 8.413 0 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.586-1.456l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.269.655 4.398 1.849 6.215l-1.266 4.625 4.735-1.247z"/></svg>`,
            facebook: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>`,
            twitter: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.299 1.634 4.211 3.803 4.652-.7.192-1.446.223-2.204.084.616 1.923 2.444 3.262 4.6 3.301-1.722 1.345-3.885 2.104-6.24 2.104-.405 0-.806-.024-1.203-.07 2.226 1.423 4.881 2.245 7.748 2.245 9.29 0 14.378-7.693 14.378-14.378 0-.219-.005-.437-.014-.654.987-.712 1.843-1.603 2.529-2.618z"/></svg>`,
            telegram: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M24 0l-6 22-8.129-7.239 7.862-8.713-10.733 8.842-8.001-2.486 24-12zm-15 16.668v7.332l3.258-4.431-3.258-2.901z"/></svg>`,
            copy: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M13.526 2.027l-5.526 5.526v-5.553h-2v8h8v-2h-5.553l5.526-5.526-2.447-2.447zm5.474 1.414l-2.447 2.447 5.526 5.526h-5.553v2h8v-8h-2v5.553l-5.526-5.526zm-13.526 13.559v-8h-2v8h-5.553l5.526 5.526-2.447 2.447 5.526-5.526h-5.553zm16-2.447l-2.447-2.447-5.526 5.526v-5.553h-2v8h8v-2h-5.553l5.526-5.526z"/></svg>`
          };

          const shareButtonsHtml = `
            <div class="share-buttons">
              <b>Bagikan:</b>
              <a href="https://api.whatsapp.com/send?text=${shareTitle}%20${encodedUrl}" target="_blank" rel="noopener noreferrer" class="share-btn" title="Bagikan ke WhatsApp">${icons.whatsapp}</a>
              <a href="https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}" target="_blank" rel="noopener noreferrer" class="share-btn" title="Bagikan ke Facebook">${icons.facebook}</a>
              <a href="https://twitter.com/intent/tweet?url=${encodedUrl}&text=${shareTitle}" target="_blank" rel="noopener noreferrer" class="share-btn" title="Bagikan ke Twitter">${icons.twitter}</a>
              <a href="https://t.me/share/url?url=${encodedUrl}&text=${shareTitle}" target="_blank" rel="noopener noreferrer" class="share-btn" title="Bagikan ke Telegram">${icons.telegram}</a>
              <button id="copy-link-btn" class="share-btn" title="Salin Tautan">${icons.copy}</button>
            </div>
          `;

          const thumbnailHtml = article.thumbnailUrl ? `<img src="${article.thumbnailUrl}" alt="${article.title}" style="width: 100%; border-radius: 12px; margin-bottom: 24px;">` : '';

          container.innerHTML = `
            <h1 class="section-title" style="font-size: 36px; line-height: 1.2;">${article.title}</h1>
            <p class="post-meta">${article.author} â€¢ ${new Date(article.createdAt).toLocaleString('id-ID', { dateStyle: 'long', timeStyle: 'short' })}</p>
            ${shareButtonsHtml}
            ${thumbnailHtml}
            <div style="font-size: 18px; line-height: 1.7;">${article.content.replace(/\n/g, '<br>')}</div>
          `;

          // Tambahkan event listener untuk tombol "Salin Tautan"
          document.getElementById('copy-link-btn').addEventListener('click', () => {
            navigator.clipboard.writeText(currentUrl).then(() => {
              alert('Tautan artikel berhasil disalin!');
            }, () => {
              alert('Gagal menyalin tautan.');
            });
          });
        } catch (error) {
          container.innerHTML = `<h2>Error</h2><p>${error.message}</p>`;
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        loadFullArticle();
      });
    </script>
    <script src="/shared.js" defer></script>
  </body>
</html>